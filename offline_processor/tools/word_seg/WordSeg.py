from .TreeNode import TreeNode
import utils.Logger
from utils import Utils


class WordSeg:
    def __init__(self, language='en'):
        self.language = language
        self.word_dict = None
        self.prefix_tree = dict()
        self.stopwords_dict = dict()

    def load_stopwords(self, stop_words = []):
        self.stopwords_dict = dict([(w,1) for w in stop_words])

    def create_prefix_tree(self):
        if self.word_dict is None:
            pass
        else:
            for word in self.word_dict:
                word_element = word.split(' ')
                if word_element[0] in self.prefix_tree.keys():
                    tree = self.prefix_tree[word_element[0]]
                else:
                    tree = TreeNode(word_element[0])
                    self.prefix_tree[word_element[0]] = tree
                for i in range(1, len(word_element)):
                    tree.add_node(word_element[i])
                    tree = tree.get_node(word_element[i])

    def cut(self, doc=None, separate=' '):
        if self.language == 'en':
            return self.cut_en(doc=doc, separate=separate)
        elif self.language == 'cn':
            result = []
            for one_doc in str(doc).split(";"):
                result.append(self.cut_cn(one_doc))
            return ",".join(result)

    def cut_en(self, doc=None, separate=' ', stopwords =[]):
        result = []
        if doc is None or not self.prefix_tree:
            return ""
        if doc == "":
            return ""
        elif type(doc) is str:
            doc = doc.split(separate)
            while doc:
                word = []
                temp_str = doc[0]
                tree_node = self.prefix_tree.get(temp_str, None)
                word.append(temp_str)
                if tree_node is None:
                    del doc[0]
                else:
                    del doc[0]
                    if not doc:
                        tree_node = None
                    else:
                        temp_str = doc[0]
                        tree_node = tree_node.get_node(temp_str)
                while tree_node is not None:
                    del doc[0]
                    word.append(temp_str)
                    if not doc:
                        tree_node = None
                    else:
                        temp_str = doc[0]
                        tree_node = tree_node.get_node(temp_str)
                result.append(" ".join(word))
                result = [w for w in result if self.stopwords_dict.get(w, 0) == 0]
        return ",".join(result)


if __name__ == '__main__':
    a = ['a b c', 'b c d']
    text = 'dtentaclemobil client is io and android applic which allow you to manag tentacl and control anemon app you can download it for free from appl appstor and googl play store both link are on our websit httpwwwanemonecloud cloud is the final compon of the platform which connect the tentacl to the mobil client but that is not all the anemon cloud can connect both the mobil client and tentacl to other api servic on the internet use connectorstentacl is open hardwar devic base on arduino yún which is the internet of thing part the our platform you can either connect as a guest to a tentacl of your friend or you can build your own which will recogn you as it master the cloud mobil client and tentacl togeth form a platform where anemon app can runand anemon app are here for you to use them to develop them and main to have some fun with themwhat can be achiev with the platformwith anemon platform you can do the followingyou can display textual inform from the the anemon cloud on tentacl display inform is store insid variabl in the cloud compon of anemon apptentacl can chang valu of variabl of it app cloud compon eg when some button on the tentacl is press or when some data is measuredyou can creat so call anemon app which contain variabl which can be shown on tentacl display andor in the mobil client app you can let user enter some data use his mobil phone adjust this data in the cloud and show result on the tentacl or you can let user interact with the tentacl and process this interact in the cloud and show the result in the mobil appth platform is done in a way that owner of a tentacl can share it to his friend or chang the run anemon app use the ota overtheair updateth anemon platform is complet open everybodi can becom a user by sign up for free everi user can either receiv a guest access or can build his own tentacl one can then instal some app from our public repositori of anemon app or he can creat his own apphow it worksmain goal of anemon platform is to provid a place where anemon app can liveanemon app is a tini piec of softwar which can be built by you we have design the anemon platform in a way that it will be extrem easi for you to make new anemon appswhat is anemon appanemon app is everi applic which run on the anemon platformeveri anemon app has three componentsmobil user interfacecloud logictentacl user interfac and logiceveri of these three compon of an anemon app run in one part of anemon platformmobil user interfac run in the mobil client appcloud logic run in the cloudtentacl user interfac and logic run on the tentaclewhen you creat these three compon you have success creat an anemon app everi anemon app is explicit defin by these three componentsmobil user interfac is defin by an interfacejson filecloud logic is defin by an manifestjson filetentacl user interfac and logic is defin by arduino ino sketch which use our anemon arduino librarymobil user interfac interfacejsonth interfacejson file describ list of input and output compon which togeth form the user interfac of anemon app which is shown insid the mobil client when your anemon app is openthrough this interfac you can either read data from your anemon app or provid data input all data are in fact load and store in the anemon cloud from where the tentacl will load themwhen defin the anemon app mobil user interfac you can use set of prepar componentsinterfac of your anemon app can look like thisin order to make this mobil user interfac you need to creat an interfacejson file which can look like this platform  appid juicyday driver anemon type interfac version 1  input  incostczk  type numberfield label cost in czk   output  outcosteur  type numberlabel label cost in eur  you can find more inform about creation of interfacejson file for anemon app in our how to defin anemon app user interfac in interfacejson tutorialcloud logic manifestjsonth manifestjson file describ list of variabl and bind which togeth form the cloud compon of everi anemon appvariableseveri variabl has a name and data type and in addit an inform whether it is readabl get or writeabl set from the tentacl the readabl and writeabl from the mobil client is defin on other place of the manifestjson  in bind variabl  varcostczk  datatyp float get true set fals  varcosteur  datatyp float get true set fals  bindingsth second part of the manifestjson file contain the list of bind there are two type of bind  user interfac bind and cloud connector bind bind  interfac   connector   user interfac bind defin insid the interfac section describ bind of variabl to user interfac compon of mobil user interfac defin in interfacejson bind  interfac  bindcostinczk  variabl varcostczk from incostczk  bindcostineur  variabl varcosteur to outcosteur   the connector bind defin insid the connector section describ bind of variabl to anemon cloud connectorsconnector is a compon of anemon cloud which provid access to other web servic like twitter of csas webapiconnector are integr in the anemon cloud list of all exist connector can be found here you can creat new connector base on our manualth connector definit look like this bind  connector  exchanger  connector exchanger variabl varcostczk arg  apikey insert your api key here  output  variabl  varcosteur     the complet manifestjson file can look like this platform  appid juicyday driver anemon type manifest version 1  variabl  varcostczk  datatyp float get true set fals  varcosteur  datatyp float get true set fals   bind  interfac  bindcostinczk  variabl varcostczk from incostczk  bindcostineur  variabl varcosteur to outcosteur   connector  exchanger  connector exchanger variabl varcostczk arg  apikey insert your api key here  output  variabl  varcosteur     you can find more inform about creation of manifestjson file for anemon app in our how to defin anemon app logic in manifestjson tutorialtentacl user interfac and logic arduino ino sketchth last compon of anemon app is the one which will run on a tentaclethi compon is in fact an arduino ino sketch file which run on the arduino yún and is the brain of the tentaclein order to make the develop of anemon sketch easier we have prepar the anemon arduino librari and default tentacl user interfac compon and screen you can find more inform about creation of arduino sketch file for anemon app in our how to creat anemon app sketch in arduino ide tutorialthi look awesom how can i startyou can use the anemon platform either as a user or as a developerin order to start as a user all you need to do issign up for free on the anemon platform websit select your account avatar while do so by a name of the icon onli  that is the real fundownload the mobil client app for io or android you can find link to app on our websit httpwwwanemonecloudfind some tentacl which you would like to control in order to control a tentacl you need to either own it which mean to build it first or be invit to it as a guesttak a full control of the tentacl you can control the run app as both guest and owner or switch the run app for anoth one or trigger tentacl share mode as owner both can be done from the mobil client or cloud administrationwhen start as a develop do the followingsign up for free on the anemon platform websit select your account avatar while do so by a name of the icon onli  that is onli way which contain the real fundownload the mobil client app for io or android you can find link to app on our websit httpwwwanemonecloudbuild a tentacl everi real develop has it own tentaclemak an anemon app prepar the interfacejson manifestjson and arduino sketch hex file for your applic login to the cloud administr and add your first anemon appinstal the app on your tentacl via ota from cloud administr by press a instal buttontest the app on your tentacl when be in a sandbox modesubmit the app for approv to the public app repositori via button in the cloud administrationth anemon team will review and approv the appeveri user of the platform can download the app and use itcongratul  you are now anemon app develop the world is yoursi want more of it  what to do nextcheck out our websitesign up for free and download the mobil clientread the how to build anemon tentacl tutorialread the how to make anemon app tutori or directlyhow to defin anemon app logic in manifestjsonhow to defin anemon app user interfac in interfacejsonhow to creat anemon app sketch in arduino ideread the how to make anemon connector tutorialyou may be also interest in the anemon app repositori list of avail anemon connector and anemon arduino librari documentationexplor the juici day exampl anemon app on our githubwrit us tweet about us write on facebook make a blogpost use hashtag anemonecloudwho is behind thisanemon platform is a result of cooper between honza sechovec and juicymoit could never be creat without support of guy from česká spořitelnaanemon has been creat with love in praguein case of ani question or issu feel free to add a github issu in this repositoryspeci thanksfor their great effort we owe a big thank to the follow peopl and entiti from the joint project develop team everybodi did a lot more then what was expect from himpedro pinto da silva for the outstand graphic design of the entir platform includ websit mobil app arduino app ui and infograph this platform design has a storymartin svoboda for the develop of anemon cloud rubi on rail applic manifest and interfac json parser and databasešimon kautský for the develop of anemon mobil client app both for io and android in unity3d and for solv all these ugli platform specif bugsfilip bursík for the develop of arduino part of anemon platform in c and for all those dreamless night when the program did not fit the small arduino yún memorymich mlejnek for the huge amount of anemon tentacl 3d case model iter in blender  includ the final one which you can print and enjoyjana moudrá for code the anemon platform present websit the one at httpwwwanemonecloud fulli respons with all the cute js featureshonza sechovec for the vision guidanc and main for the patienc the develop of the platform took a bit longer than expect but the result is worth ittomáš jukin for the platform architectur and the fact that all the stuff fit well togeth and for the ugli electron stuff the document slice solder and 3d printingkanárek which is a prusa3d i3 mk2 3d printer for print everi singl iter of the anemon tentacl 3d case model and still workus technologiesthey say great scienc is built on the shoulder of giant  cave johnsonanemon platform is build use well known technolog you should not missanemon tentacl is an open hardwar devic build around on the arduino yún and arduino tft displayanemon cloud is creat use rubi on railsanemon mobil client is program in uniti how can i contributejoin the platform either as a user or develop you can join the anemon platform and explor the world of iot in a fun way see httpwwwanemonecloudspread the word i you know somebodi who might be interest in our platform invit him ale show him your tentaclemak your own app base on manualmak new connector and submit them as pull request to this repositoryinterest in serious develop wanna extend the platform itself contact honza at honzaflexerczfaqi plug my tentacl but it has blank screen and it is not do anyth how to solv thisarduino yún is a terribl slow devic so when you turn it on typicali by plugin in the usb cabl it will just turn on the green led an do noth in this time the arduino yún linuxwifi part is boot up when this will finish the ýun will turn on a white led this can took up to 5 min and this is the moment when it will start the arduino sketch an henc your anemon app as wellaft the initi setup a so call initi arduino sketch is instal on your tentacl by the tentaclesh script you have download from the anemon cloud admin this sketch just show the readi for app instal text and imageaft 60 second the initi arduino sketch will tri to perform an ota updatebecaus the hardwar limit of the arduino yún especi the way how the spi bus is wire to the icsp pin on yún the tft screen need to be turn off prior an ota updat this is whi the screen goe black when ota updat is in progressand becaus arduino yún is quit slow the ota updat can take up to 5 minut event on fast internet connectionso the solut of this is just wait till the ota updat will complet your app will run after itw know that this is not the best userfriend behavior and we are work on a possibl solut which could make this better in futur so have cross for us fingersmi tentacl freez and it is not respond to anyth how to fix thisarduino yún is abl to veri often corrupt it memori and complet freez the anemon platform is prepar to this and in this case you can save the situat by perform the followingtri to ssh to your tentacl if that is still possibl run there the tentacl initi script tentaclesh again if you do not have it feel free to download it again from anemon cloud the tentaclesh is design to be idempot which simpli mean that it is ok to run it multipl time tentaclesh will initi the tentacl onc again and onc again will instal the initi sketch but after 60s in it updat period the initi sketch will automat detect that some anemon app is alreadi instal on the tentacl and will automat perform the ota to it and becaus the anemon app state  it variabl is alway store in anemon cloud your app will be back up with all it data this should solv your issueif the hint from step 1 did not help probabl becaus the tentaclearduino yún is no longer respond to anyth includ ssh tri to turn the tentacl off and on by cut power to it  do not reli on the onboard reset button when you plug it to power again wait till the arduino yún complet it boot  it will turn on the white led on it surfac  it take around 5 min now your tentacl might resum it normal oper that mean that your anemon app should boot up if not tri if at least the ssh is work and follow instruct from step 1if even hint from step 2 were not help your arduino yún went complet stuck this happen multipl time to us dur the develop of the platform  in this case noth els than a yún linux imag reset will help you follow instruct on the offici tutori how to reset arduino yún linux imag that usual help when done follow with instruct from the step 1how can i connect to a tentacl as a guestyou need to access the tentacl physic and press the cloud button locat below the left bottom corner of the screen or you can convinc the tentacl owner to press the key button in his mobil client app on his tentacl info pagethi will initi a share mode of the tentacl when in this mode tentacl will show a four digit guest code on it screen  eg 1234when you physic access a tentacl in share mode you can type it guest code to your mobil client app after press the add tentacl button on the dashboardth tentacl will now appear in your mobil client under the guest box label you can now control the anemon app which is run on ithow can i build a tentaclejust follow our manual it includ a part list and even a model of cute case which can be 3d print all the difficult stuff is done what remain are just the fun part term and licensethi softwar is licens under mit licenseanemonecloud'
    word_dict = Utils.load_word_dict_en()
    stop_words = Utils.load_stopwords('en')
    seg = WordSeg('en')
    seg.load_dict(word_dict)
    seg.load_stopwords(stop_words)
    print(type(text))
    print(str)
    print(seg.cut_with_tag(text,' ', []))
